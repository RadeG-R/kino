<!DOCTYPE html>
{% load static %}
<html lang="pl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Index - Kino</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;display=swap" rel="stylesheet" integrity="sha384-2kgbXYtcPwTEKKd9uAMlGhTUhEfAuJJgdJ0nFX75iuG76hxM2b3LxElZ1d4x6MVNV" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" integrity="sha512-sL7M4v0zCLf3V+Jeu+zHLxjfHEQhJQzKQQ/AKQDEYPZKvFbXH4LREqBn7k7N3/7Nzpjc3BFcK4v5rXVXVUpjQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js" integrity="sha512-WXoSL2lrKOSIDlnw6/wlCH/IcZliJrJm9qfmUZoqhAW4PILCy11vpQclusCse+WcFW8z9gfqnFnRV4fsHy3V7g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>

<body>

<!-- COOKIES CONSENT BANNER -->
<div class="cookies-banner" id="cookies-banner">
  <div class="cookies-content">
    <div class="cookies-text">
      ğŸª UÅ¼ywamy cookies do zapamiÄ™tywania Twoich preferencji i zapewnienia bezpieczeÅ„stwa. Poprzez klikniÄ™cie "Zaakceptuj" wyraÅ¼asz zgodÄ™ na uÅ¼ycie wszystkich cookies. 
      <a href="{% url 'cookies' %}">Dowiedz siÄ™ wiÄ™cej</a>
    </div>
    <div class="cookies-buttons">
      <button class="cookies-btn cookies-btn--reject" id="cookies-reject">OdrzuÄ‡</button>
      <button class="cookies-btn cookies-btn--accept" id="cookies-accept">Zaakceptuj</button>
    </div>
  </div>
</div>

<header class="site-header">
  <div class="accessibility-panel">
    <button id="text-decrease">A-</button>
    <button id="text-increase">A+</button>
    <button id="text-reset">Reset</button>
    <button id="contrast-toggle">Kontrast</button>
  </div>

  <div class="container nav-wrapper">
    <a href="{% url 'index' %}" class="brand">ğŸ¬ Kino</a>
    <nav class="nav">
      <a href="{% url 'filmy' %}">Filmy</a>
      <a href="{% url 'seanse' %}">Seanse</a>

      {% if user.is_authenticated %}
        <a href="{% url 'konto' %}">Moje Konto</a>
        <form action="{% url 'logout' %}" method="post" class="nav-logout-form">
          {% csrf_token %}
          <button type="submit" class="nav-logout-button">Wyloguj siÄ™</button>
        </form>
      {% else %}
        <a href="{% url 'login' %}">Zaloguj siÄ™</a>
      {% endif %}

      <a href="{% url 'admin-panel' %}">Admin</a>
    </nav>
  </div>
</header>

<main>

  <!-- HERO - GÅÃ“WNY CTA -->
  <section class="hero" aria-labelledby="hero-title">
    <video autoplay muted loop playsinline>
      <source src="https://cdn.pixabay.com/video/2021/07/08/80685-573496118_large.mp4" type="video/mp4">
    </video>

    <div class="container">
      <h1 id="hero-title">Odkryj nowe filmy</h1>
      <p>Zarezerwuj bilet na swÃ³j ulubiony film w kilka sekund</p>
      <a href="{% url 'seanse' %}" class="btn btn-lg">Zarezerwuj bilet</a>
    </div>
  </section>

  <!-- SEKCJA: TOP OCENIANE FILMY -->
  {% if top_rated_filmy %}
  <section class="container top-rated-section">
    <h2>â­ Najlepiej oceniane filmy</h2>
    <p class="section-intro">Poznaj filmy, ktÃ³re cieszÄ… siÄ™ najwiÄ™kszym uznaniem naszych widzÃ³w. KaÅ¼dy film ma Å›redniÄ… ocenÄ™ opartÄ… na recenzjach uÅ¼ytkownikÃ³w.</p>
    
    <div class="top-rated-grid">
      {% for film in top_rated_filmy %}
      <div class="top-rated-card">
        <div class="film-info">
          <h3>{{ film.tytul }}</h3>
          
          <div class="rating-section">
            <div class="stars-container">
              {% with gwiazdki=film.ilosc_gwiazdek %}
              {% with whole=gwiazdki|floatformat:0 %}
              {% with decimal=gwiazdki|add:"0.5"|floatformat:0 %}
              
              <span class="star {% if gwiazdki >= 1 %}filled{% endif %}">â˜…</span>
              <span class="star {% if gwiazdki >= 2 %}filled{% elif gwiazdki > 1 %}half{% endif %}">â˜…</span>
              <span class="star {% if gwiazdki >= 3 %}filled{% elif gwiazdki > 2 %}half{% endif %}">â˜…</span>
              <span class="star {% if gwiazdki >= 4 %}filled{% elif gwiazdki > 3 %}half{% endif %}">â˜…</span>
              <span class="star {% if gwiazdki >= 5 %}filled{% elif gwiazdki > 4 %}half{% endif %}">â˜…</span>
              
              {% endwith %}
              {% endwith %}
              {% endwith %}
            </div>
            <span class="rating-value">{{ film.srednia_ocena|floatformat:1 }}/5</span>
          </div>
          
          <p class="review-meta">
            {% with count=film.recenzje.count %}
              <strong>{{ count }}</strong> opini{{ count|pluralize:"a,e,a" }}
            {% endwith %}
          </p>
          
          <p class="film-description">{{ film.opis|truncatewords:15 }}</p>
          
          <div class="film-meta">
            {% if film.reÅ¼yser %}
              <p><strong>ReÅ¼yseria:</strong> {{ film.reÅ¼yser }}</p>
            {% endif %}
            {% if film.gatunek %}
              <p><strong>Gatunek:</strong> {{ film.gatunek }}</p>
            {% endif %}
          </div>
          
          <a href="{% url 'film-detail' film.pk %}" class="btn btn--secondary">SzczegÃ³Å‚y</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <!-- SEKCJA: Aktualnie w kinie -->
  <section class="container current-movies-section">
    <h2>ğŸ¬ Aktualnie w kinie</h2>
    <p class="section-intro">PeÅ‚na lista filmÃ³w dostÄ™pnych w naszym kinie. Przejrzyj szczegÃ³Å‚y kaÅ¼dego tytuÅ‚u, przeczytaj opinie i dokonaj rezerwacji.</p>

    <div class="movies-list">
      {% for film in page_obj %}
      <div class="movie-row">
        <div class="movie-content">
          <h3>{{ film.tytul }}</h3>
          <p class="movie-meta">
            {% if film.rok_produkcji %}
              <span>{{ film.rok_produkcji }}</span>
            {% endif %}
            {% if film.gatunek %}
              <span>{{ film.gatunek }}</span>
            {% endif %}
            {% if film.kraj_pochodzenia %}
              <span>{{ film.kraj_pochodzenia }}</span>
            {% endif %}
          </p>
          <p class="movie-description">{{ film.opis|truncatewords:20 }}</p>
          <a href="{% url 'film-detail' film.pk %}" class="btn btn--secondary">SzczegÃ³Å‚y</a>
        </div>
        {% if film.plakat %}
        <div class="movie-poster-small">
          <img src="{{ film.plakat.url }}" alt="Plakat filmu {{ film.tytul }}" loading="lazy">
        </div>
        {% endif %}
      </div>
      {% endfor %}
    </div>

    <div class="pagination-controls">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="btn">&laquo; Poprzednia</a>
      {% endif %}

      <span class="page-info">Strona {{ page_obj.number }} z {{ page_obj.paginator.num_pages }}.</span>

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="btn">NastÄ™pna &raquo;</a>
      {% endif %}
    </div>
  </section>

  <!-- SEKCJA: NADCHODZÄ„CE SEANSE -->
  {% if upcoming_seanse %}
  <section class="container upcoming-section">
    <h2>ğŸ“… NadchodzÄ…ce seanse</h2>
    <p class="section-intro">SprawdÅº harmonogram kolejnych seansÃ³w i zarezerwuj bilety na interesujÄ…ce CiÄ™ przedstawienia.</p>
    
    <div class="upcoming-grid">
      {% for seans in upcoming_seanse %}
      <div class="upcoming-card">
        <div class="seans-time-badge">
          {{ seans.data_i_godzina|date:"d.m" }}<br>
          <strong>{{ seans.data_i_godzina|date:"H:i" }}</strong>
        </div>
        <div class="seans-details">
          <h3>{{ seans.film.tytul }}</h3>
          <a href="{% url 'rezerwacja' seans.id %}" class="btn btn--small">Zarezerwuj bilet</a>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endif %}
</main>

<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-section">
      <h4>â„¹ï¸ Informacje</h4>
      <ul>
        <li><a href="{% url 'info' %}">O nas</a></li>
        <li><a href="{% url 'info' %}#godziny-otwarcia">Godziny otwarcia</a></li>
        <li><a href="{% url 'kontakt' %}">Kontakt</a></li>
        <li><a href="{% url 'faq' %}">FAQ</a></li>
      </ul>
    </div>

    <div class="footer-section">
      <h4>ğŸ“Œ Lokalizacja</h4>
      <div id="map" class="map-container"></div>
    </div>

    <div class="footer-section">
      <h4>ğŸ“± Media SpoÅ‚ecznoÅ›ciowe</h4>
      <div class="social-links">
        <a href="https://facebook.com" target="_blank" rel="noopener" class="social-icon" title="Facebook">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
        </a>
        <a href="https://instagram.com" target="_blank" rel="noopener" class="social-icon" title="Instagram">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0m0 2.16c2.716 0 3.05.01 4.122.06 1.065.049 1.644.228 2.025.379.51.197.873.434 1.255.816.382.382.619.745.816 1.255.151.381.33.96.379 2.025.05 1.072.06 1.406.06 4.122 0 2.716-.01 3.05-.06 4.122-.049 1.065-.228 1.644-.379 2.025-.197.51-.434.873-.816 1.255-.382.382-.745.619-1.255.816-.381.151-.96.33-2.025.379-1.072.05-1.406.06-4.122.06-2.716 0-3.05-.01-4.122-.06-1.065-.049-1.644-.228-2.025-.379-.51-.197-.873-.434-1.255-.816-.382-.382-.619-.745-.816-1.255-.151-.381-.33-.96-.379-2.025-.05-1.072-.06-1.406-.06-4.122 0-2.716.01-3.05.06-4.122.049-1.065.228-1.644.379-2.025.197-.51.434-.873.816-1.255.382-.382.745-.619 1.255-.816.381-.151.96-.33 2.025-.379 1.072-.05 1.406-.06 4.122-.06m0 3.697c-2.9 0-5.252 2.353-5.252 5.252 0 2.9 2.353 5.252 5.252 5.252 2.9 0 5.252-2.353 5.252-5.252 0-2.9-2.353-5.252-5.252-5.252m0 8.666c-1.886 0-3.414-1.529-3.414-3.414 0-1.886 1.529-3.414 3.414-3.414 1.887 0 3.414 1.529 3.414 3.414 0 1.886-1.527 3.414-3.414 3.414m5.464-8.993c0 .678-.549 1.227-1.227 1.227-.678 0-1.228-.549-1.228-1.227s.55-1.227 1.228-1.227c.678 0 1.227.549 1.227 1.227"/></svg>
        </a>
        <a href="https://x.com" target="_blank" rel="noopener" class="social-icon" title="X">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24h-6.627l-5.1-6.694-5.867 6.694h-3.306l7.73-8.835L2.882 2.25h6.791l4.623 6.11 5.348-6.11zM17.15 18.738h1.828L5.966 4.156H4.081l13.069 14.582z"/></svg>
        </a>
        <a href="https://youtube.com" target="_blank" rel="noopener" class="social-icon" title="YouTube">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/></svg>
        </a>
      </div>
    </div>
  </div>

  <div class="footer-bottom">
    <p><span id="year"></span> ğŸ¬ Kino â€” Wszelkie prawa zastrzeÅ¼one.</p>
    <p style="font-size: 0.8rem; margin-top: 0.5rem;">
      <a href="{% url 'polityka' %}">Polityka prywatnoÅ›ci</a> | 
      <a href="{% url 'regulamin' %}">Regulamin</a> | 
      <a href="{% url 'cookies' %}">Cookies</a>
    </p>
  </div>
</footer>

<script src="{% static 'js/main.js' %}"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const mapContainer = document.getElementById('map');
  if (mapContainer && typeof L !== 'undefined') {
    const randomLat = 52.0 + (Math.random() - 0.5) * 0.15;
    const randomLng = 21.0 + (Math.random() - 0.5) * 0.15;
    
    const map = L.map('map').setView([randomLat, randomLng], 13);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors',
      maxZoom: 19
    }).addTo(map);
    
    L.marker([randomLat, randomLng]).addTo(map)
      .bindPopup('ğŸ“ Nasze kino w Warszawie');
  }
});
</script>
</body>
</html>
